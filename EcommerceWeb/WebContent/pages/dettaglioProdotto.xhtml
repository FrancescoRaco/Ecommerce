<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:custom="http://java.sun.com/jsf/composite/custom"
	template="/pages/templates/pageTemplate.xhtml">
	
	<ui:define name="title">
		<title>Dettaglio prodotto</title>
	</ui:define>
	
	<ui:define name="effettuaOperazioniIniziali">
		<f:event listener="#{dettaglioController.effettuaOperazioniIniziali}" type="preRenderView"></f:event>
	</ui:define>
	
	<ui:define name="content">
		<br/><br/>
		<p class="text-center h1">Dettaglio prodotto</p>
		<br/><br/>
		<h:form>
			<div class="row">
				<div class="col-12 col-sm-4">
					<h:outputLabel for="prodottoId" value="Identificativo:" styleClass="control-label"/>
					<h:inputText id="prodottoId" value="#{dettaglioBean.prodottoDTO.id}" styleClass="form-control" disabled="true"/>
				</div>
				<div class="col-12 col-sm-4">
					<h:outputLabel for="titoloId" value="Titolo:" styleClass="control-label"/>
					<h:inputText id="titoloId" value="#{dettaglioBean.prodottoDTO.titolo}" styleClass="form-control" disabled="true"/>
				</div>
				<div class="col-12 col-sm-4">
					<h:outputLabel for="categoriaId" value="Categoria:" styleClass="control-label"/>
					<h:inputText id="categoriaId" value="#{dettaglioBean.prodottoDTO.descCategoria}" styleClass="form-control" disabled="true"/>
				</div>
			</div>
			<br/>
			<div class="row">
				<div class="col-12 col-sm-4">
					<h:outputLabel for="cfvenditoreId" value="Venditore:" styleClass="control-label"/>
					<h:inputText id="cfVenditoreId" value="#{dettaglioBean.prodottoDTO.cfVenditore}" styleClass="form-control" disabled="true"/>
				</div>
				<div class="col-12 col-sm-4">
					<h:outputLabel for="disponibilitaId" value="Disponibilità:" styleClass="control-label"/>
					<h:inputText id="disponibilitaId" value="#{dettaglioBean.prodottoDTO.disponibilita}" styleClass="form-control" disabled="true"/>
				</div>
				<div class="col-12 col-sm-4">
					<h:outputLabel for="prezzoBaseId" value="Prezzo base:" styleClass="control-label"/>
					<h:inputText id="prezzoBaseId" value="#{dettaglioBean.prodottoDTO.prezzoBase}" styleClass="form-control" disabled="true"/>
				</div>
			</div>
			<br/>
			<div class="row">
				<div class="col-12 col-sm-4">
					<h:outputLabel for="dataInserimentoId" value="Data inserimento:" styleClass="control-label"/>
					<h:inputText id="dataInserimentoId" value="#{dettaglioBean.prodottoDTO.dataInserimento}" styleClass="form-control" disabled="true">
						<f:convertDateTime pattern="dd/MM/yyyy"/>
					</h:inputText>
				</div>
				<div class="col-12 col-sm-4">
					<h:outputLabel for="dataAggiornamentoId" value="Data aggiornamento:" styleClass="control-label"/>
					<h:inputText id="dataAggiornamentoId" value="#{dettaglioBean.prodottoDTO.dataAggiornamento}" styleClass="form-control" disabled="true">
						<f:convertDateTime pattern="dd/MM/yyyy"/>
					</h:inputText>
				</div>
			</div>
			<br/>
			<div class="row">
				<div class="col-12">
					<h:outputLabel for="descrizioneId" value="Descrizione:" styleClass="control-label"/>
					<h:inputTextarea id="descrizioneId" value="#{dettaglioBean.prodottoDTO.descrizione}" styleClass="form-control" disabled="true"/>
				</div>
			</div>
			<br/>
			<div class="row">
				<div class="col-12">
					<h:outputLabel for="infoAcquirentiId" value="Informazioni per gli acquirenti:" styleClass="control-label"/>
					<h:inputTextarea id="infoAcquirentiId" value="#{dettaglioBean.prodottoDTO.infoAcquirenti}" styleClass="form-control" disabled="true"/>
				</div>
			</div>
			<br/>
			<h:panelGroup layout="block" styleClass="card" rendered="#{not empty dettaglioBean.prodottoDTO and dettaglioBean.prodottoDTO.cfVenditore ne utenteBean.codiceFiscale}">
			  <div class="card-body">
			    <h4 class="card-title text-center">Sezione ordini</h4>
			    <br/>
			    <div class="row">
			    	<div class="col-12 col-sm-4">
			    		<h:outputLabel for="offertaId" value="Offerta:*" styleClass="control-label"/>
						<h:inputText id="offertaId" value="#{dettaglioBean.offertaWrap}" styleClass="form-control #{messagesBean.invalidFields.contains('offertaId') ? 'is-invalid' : ''}"/>
			    	</div>
			    	<div class="col-12 col-sm-4">
			    		<h:outputLabel for="quantitaId" value="Quantità:*" styleClass="control-label"/>
						<h:inputText id="quantitaId" value="#{dettaglioBean.quantitaWrap}" styleClass="form-control #{messagesBean.invalidFields.contains('quantitaId') ? 'is-invalid' : ''}"/>
			    	</div>
			    	<div class="col-12 col-sm-4">
			    		<h:outputLabel for="noteAcquirenteId" value="Note acquirente:" styleClass="control-label"/>
						<h:inputText id="noteAcquirenteId" value="#{dettaglioBean.noteAcquirente}" styleClass="form-control #{messagesBean.invalidFields.contains('noteAcquirenteId') ? 'is-invalid' : ''}"/>
			    	</div>
			    </div>
			    <br/>
			   	<div class="text-center">
					<div class="row btn-group">
						<div class="col-sm-6">
							<h:commandButton value="Ripulisci" action="#{dettaglioController.ripulisciOrdine()}" styleClass="btn btn-primary"/>
						</div>
						<div class="col-sm-6">
							<h:commandButton value="Invia ordine" action="#{dettaglioController.inviaOrdine()}" styleClass="btn btn-primary"/>
						</div>
					</div>
				</div>
			  </div>
			</h:panelGroup>
			<h:panelGroup layout="block" styleClass="row" rendered="#{utenteBean.codiceFiscale eq dettaglioBean.prodottoDTO.cfVenditore and dettaglioBean.tabellaOrdiniAbilitata and dettaglioBean.paginatorOrdini.page != null and !empty dettaglioBean.paginatorOrdini.page and dettaglioBean.paginatorOrdini.totalPages > 0}" >
				<div class="col-sm-12">
					<br/>
					<div class="table-responsive">				
						<table class="table table-striped table-hover table-header table-bordered" id="tabellaOrdiniId">
							<caption class="sr-only">
								Tabella degli ordini ricevuti
							</caption>
							<thead class="text-center">
								<tr class="table-main">
									<th colspan="5">Tabella degli ordini ricevuti</th>
								</tr>
								<tr class="table-main">
									<th>Identificativo prodotto</th>
									<th>Progressivo ordine</th>
									<th>Offerta</th>
									<th>Quantita</th>
									<th>Stato</th>																
								</tr>
							</thead>
							<tbody class="text-center">
								<ui:repeat var="ordine" value="#{dettaglioBean.paginatorOrdini.page}">
									<tr>
										<td>
											<h:commandLink value="#{ordine.idProdotto}" action="#{dettaglioController.visualizzaOrdine()}" styleClass="btn btn-link">
												<f:setPropertyActionListener value="#{ordine}" target="#{ordineBean.ordineDTO}"></f:setPropertyActionListener>
											</h:commandLink>
										</td>																					
										<td><h:outputText value="#{ordine.progressivo}" /></td>	
										<td><h:outputText value="#{ordine.offerta}" /></td>																						
										<td><h:outputText value="#{ordine.quantita}" /></td>
										<td><h:outputText value="#{ordine.flagAccettazione eq 0 ? 'In lavorazione' : (ordine.flagAccettazione eq 1 ? 'Accettata' : 'Rifiutata')}" /></td>																					
									</tr>
								</ui:repeat>
							</tbody>
						</table>
						<custom:paginator paginator="#{dettaglioBean.paginatorOrdini}"/>
					</div>
				</div>
				<br/>
			</h:panelGroup>
			<div class="row btn-group">
				<h:panelGroup layout="block" styleClass="col-12" rendered="#{not empty dettaglioBean.provenienza and dettaglioBean.provenienza eq 'ricercaProdotti.xhtml'}">
					<br/>
					<h:commandLink action="#{dettaglioController.backToRicercaProdotti()}" styleClass="btn btn-primary">
						<i class="fas fa-arrow-left pr-1"/>
						Indietro
					</h:commandLink>
				</h:panelGroup>
				<h:panelGroup layout="block" styleClass="col-12" rendered="#{not empty dettaglioBean.provenienza and dettaglioBean.provenienza eq 'vendite.xhtml'}">
					<br/>
					<h:commandLink action="#{dettaglioController.backToVendite()}" styleClass="btn btn-primary">
						<i class="fas fa-arrow-left pr-1"/>
						Indietro
					</h:commandLink>
				</h:panelGroup>
			</div>
		</h:form>
	</ui:define>

</ui:composition>